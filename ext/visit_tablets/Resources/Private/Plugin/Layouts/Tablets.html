<f:if condition="{settings.varDump}">
    <f:debug>{_all}</f:debug>
</f:if>

 <div class="titleBar">
    <nav>
        <div class="left">
            <span data-toggle="modal" data-target="#startModal">
                <i class="mdi mdi-home"></i>
                <h1 class="spacer-left">


                        <f:render section="title" />

                    <f:comment>
                        <f:cObject typoscriptObjectPath="lib.dynamicContent" data="{pageUid: '{data.uid}', colPos: '1'}" />
                    </f:comment>
                </h1>
            </span>
        </div>
        <div class="right">



            <span class="spacer-left" data-toggle="modal" data-target="#startModal">
                 <i class="mdi mdi-comment-processing-outline"></i> Sprache | Language
            </span>


            <span class="spacer-left" data-toggle="modal" data-target="#imprint">
                <i class="mdi mdi-help-circle"></i> Impressum | Imprint
            </span>

        </div>

    </nav>
</div>
<main>
    <f:render section="main" />
</main>


<f:render section="footer" optional="1" />

<script>

    //caching
    var filesToCache = [window.location.pathname+window.location.search];
    var SKIP_URLS = ["http://leafletjs.com/"];

    function addToCacheList(elements, attr) {
        for (let i = 0; i < elements.length; i++) {
            let url = elements[i][attr];
            if (url && url.length > 0 && url.startsWith("http") && SKIP_URLS.indexOf(url) == -1) {
                filesToCache.push(url);
            }
        }
    }

    addToCacheList(document.getElementsByTagName("link"), "href");
    addToCacheList(document.getElementsByTagName("script"), "href");
    addToCacheList(document.getElementsByTagName("img"), "src");


    self.addEventListener('install', function(event) {
        event.waitUntil(
            caches.open('visit').then(function(cache) {
                return cache.addAll(filesToCache)
            })
        );
    });

    self.addEventListener('fetch', function(event) {
        event.respondWith(
            fetch(event.request).catch(function() {
                return caches.match(event.request);
            })
        );
    });
</script>